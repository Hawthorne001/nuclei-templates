id: centos-eol

info:
  name: CentOS EOL - Detect
  author: staticnoise
  severity: info
  description: |
    Detected CentOS systems that had reached End-of-Life (EOL) status by identifying outdated version information in HTTP response.
  reference:
    - https://endoflife.date/centos
    - https://blog.centos.org/2023/04/end-dates-are-coming-for-centos-stream-8-and-centos-linux-7/
  metadata:
    max-request: 1
    shodan-query: '"Server: Apache/" "centos"'
    fofa-query: 'header="Server: Apache/" && "centos"'
  tags: centos,eol,tech

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    host-redirects: true
    max-redirects: 2

    matchers:
      - type: regex
        part: header
        regex:
          - 'Apache/(\d+\.\d+\.\d+) \((centos|CentOS)\)'
