id: onion-website-supported

info:
  name: Onion Website Supported via Onion-Location Header
  author: rxerium
  severity: info
  description: |
    Identified websites that supported Tor network access through the Onion-Location HTTP response header, which pointed to a corresponding .onion service for enhanced privacy and anonymity.
  metadata:
    verified: true
    max-request: 1
  tags: misc,osint,tor,onion

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers:
      - type: regex
        part: header
        regex:
          - '(?i)onion-location:\s*https?://[a-z0-9]+\.onion'

    extractors:
      - type: regex
        part: header
        group: 1
        regex:
          - '(?i)onion-location:\s*(https?://[a-z0-9]+\.onion)'
# digest: 4a0a0047304502205f8542c65af51a2019894ce4d2ca2e9d3cff612d93e5985b2d9f14a62084f8be0221008ee6a7b9c3b673b075a0ef7cd01c0c527967211785e1f4aa3dd44c388337e9a7:922c64590222798bb761d5b6d8e72950