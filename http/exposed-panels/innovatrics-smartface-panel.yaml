id: innovatrics-smartface-panel

info:
  name: SmartFace - Panel
  author: matejsmycka
  severity: medium
  description: |
    SmartFace Login was detected. This panel is used for facial recognition from video streams.
    Attackers can extract connection strings to cameras and other sensitive information from the panel.
  metadata:
    max-request: 1
    shodan-query: http.favicon.hash:-1410437493
  tags: panel,smartface,login,detect
  reference:
    - https://www.innovatrics.com/face-recognition-solutions/

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    host-redirects: true
    max-redirects: 2

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        condition: and
        part: header
        words:
          - "X-Powered-By: Express"

      - type: word
        condition: and
        part: body
        words:
          - "Smartface"