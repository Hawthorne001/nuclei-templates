id: apache-mod-cluster-exposure

info:
  name: Apache `mod_proxy_cluster` Cluster Manager Interface - Exposure
  author: oleveloper
  severity: info
  description: |
    The Apache mod_proxy_cluster management interface provides administrative control and visibility into the load balancerâ€™s nodes and contexts.
  reference:
    - https://httpd.apache.org/docs/2.4/mod/mod_proxy_cluster.html
  metadata:
    max-request: 3
    verified: true
  tags: apache,mod_proxy,cluster,exposure

http:
  - method: GET
    path:
      - "{{BaseURL}}/mcm"
      - "{{BaseURL}}/cluster-manager"
      - "{{BaseURL}}/mod_cluster_manager"

    host-redirects: true
    max-redirects: 2

    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'contains_any(body, "Mod_cluster Status","Protocol supported","mod_proxy_cluster")'
          - 'contains(header, "text/html")'
          - 'status_code == 200'
        condition: and
