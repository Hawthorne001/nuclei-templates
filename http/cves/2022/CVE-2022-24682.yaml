id: CVE-2022-24682

info:
  name: Zimbra Collaboration - 	Improper Encoding
  author: rxerium
  severity: medium
  description: |
    An issue was discovered in the Calendar feature in Zimbra Collaboration Suite 8.8.x before 8.8.15 patch 30 (update 1), as exploited in the wild starting in December 2021. An attacker could place HTML containing executable JavaScript inside element attributes. This markup becomes unescaped, causing arbitrary markup to be injected into the document.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2022-24682
    - https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-228a
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-24682
    cwe-id: CWE-116
  metadata:
    max-request: 1
    vendor: zimbra
    product: collaboration
    shodan-query:
      - http.favicon.hash:"1624375939"
      - http.html:"Zimbra Collaboration Suite Web Client"
    fofa-query: icon_hash="1624375939"
  tags: cve,cve2022,zimbra,kev,passive

http:
  - method: GET
    path:
      - "{{BaseURL}}/js/zimbraMail/share/model/ZmSettings.js"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Zimbra Collaboration Suite Web Client"

      - type: word
        part: header
        words:
          - "application/x-javascript"

      - type: word
        words:
          - "8.8"
          - "8.8.6"
          - "8.8.7"
          - "8.8.8"
          - "8.8.9"
          - "8.8.10"
          - "8.8.11"
          - "8.8.12"
          - "8.8.13"
          - "8.8.14"
        part: version

      - type: regex
        regex:
          - "8.8.15p[12]"

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - 'CLIENT_VERSION\",                    {type:ZmSetting.T_CONFIG, defaultValue:\"(.*?)"'