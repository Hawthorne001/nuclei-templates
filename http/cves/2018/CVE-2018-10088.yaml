id: CVE-2018-10088

info:
  name: XiongMai uc-httpd 1.0.0 - Buffer Overflow
  author: 0x_Akoko
  severity: critical
  description: |
    XiongMai uc-httpd 1.0.0 contains a buffer overflow vulnerability (CVE-2018-10088) that
    allows unauthenticated attackers to potentially execute arbitrary code or cause denial
    of service. This template performs version detection to identify vulnerable instances.
  impact: |
    The identified version is vulnerable to buffer overflow attacks that could result in
    remote code execution, denial of service, device crashes, and service disruption.
  remediation: |
    Update to the latest version of uc-httpd or apply security patches provided by the vendor.
    Implement network access controls to limit exposure and restrict access to vulnerable services.
    Monitor for suspicious login attempts with abnormal parameters that could indicate exploitation attempts.
    Consider replacing with updated firmware or alternative HTTP server solutions if patches are unavailable.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2018-10088
    - https://www.exploit-db.com/exploits/44864
    - https://github.com/bitfu/uc-httpd-1.0.0-buffer-overflow-exploit
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2018-10088
    cwe-id: CWE-119
    epss-score: 0.32764
    epss-percentile: 0.96643
    cpe: cpe:2.3:a:xiongmaitech:uc-httpd:1.0.0:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: xiongmaitech
    product: uc-httpd
    is_kev: true
    is_poc: true
    is_remote: true
    shodan-query:
      - 'server:"uc-httpd 1.0.0"'
      - cpe:"cpe:2.3:a:xiongmaitech:uc-httpd:1.0.0"
    fofa-query: 'server="uc-httpd 1.0.0"'
  tags: cve,cve2018,xiongmai,buffer-overflow,rce,version-detection,kev,critical

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers:
      - type: dsl
        dsl:
          - "status_code == 200 && contains(tolower(header), 'uc-httpd') && compare_versions(version, '<= 1.0.0')"

    extractors:
      - type: regex
        name: version
        part: header
        group: 1
        regex:
          - '(?i)Server:\s*uc-httpd[/\s]+([0-9]+\.[0-9]+\.[0-9]+)'
        internal: true

      - type: dsl
        dsl:
          - '"XiongMai uc-httpd " + version + " - CVE-2018-10088 Buffer Overflow"'
